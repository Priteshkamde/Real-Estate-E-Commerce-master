{% extends 'ecommerce/base.html' %}
{% block title %}Home{% endblock %}

{% block body %}
{% load static %}


<div class="list-group">
    <button type="button" class="btn btn-info">
        <h3>{{ property.property_title }}</h3>
    </button>
    <ul class="list-group list-group-flush">
        {% for image in images %}
        {% ifequal image.post property %}

        <li class="list-group-item"><img src="{{ image.image.url }}" alt="{{ property.property_title }}"></li>
        {% endifequal %}
        {% endfor %}
        <li class="list-group-item"><h5>Locality: {{ property.locality }}</h5></li>
        <li class="list-group-item">for {{ property.buy_rent }}</li>
        <li class="list-group-item">for {{ property.property_type }}</li>
        <li class="list-group-item">Price: Rs. {{ property.price }}</li>
        <li class="list-group-item">BHK: {{ property.BHK }}</li>
        <li class="list-group-item">Construction Status: {{ property.construction_status }}</li>
        <li class="list-group-item">Area: {{ property.area }} sq. ft.</li>
        <li class="list-group-item">Address: {{ property.address }}</li>
        <li class="list-group-item">Description: {{ property.description }}</li>
        <li class="list-group-item">
            {% if user.is_authenticated %}
            {% ifequal property.buy_rent 'Sale' %}
            {% ifequal user.type 'buyer' %}
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                Get Contact
            </button>

            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            {% ifequal user.username property.user.username %}
            <p>You own this post</p>
            {% else %}
            <p>You need to be a registered buyer to see the post owner's contact details. Login <a
                    href="{% url 'ecommerce:login_user' %}">here</a></p>
            {% endifequal %}
            {% endifequal %}
            {% else %}
            {% ifequal property.buy_rent 'Rent' %}
            {% ifequal user.type 'tenant' %}
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                Get Contact
            </button>

            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            ...
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            {% ifequal user.username property.user.username %}
            <p>You own this post</p>
            {% else %}
            <p>You need to be a registered tenant to see the post owner's contact details. Login <a
                    href="{% url 'ecommerce:login_user' %}">here</a></p>
            {% endifequal %}
            {% endifequal %}
            {% endifequal %}
            {% endifequal %}
            {% endif %}
        </li>
    </ul>
</div>


<!--<h4>for {{ property.buy_rent }}</h4>-->
<!--<h4>Type:{{ property.property_type }}</h4>-->
<!--<h4>Price: Rs. {{ property.price }}</h4>-->
<!--<h4>BHK: {{ property.BHK }}</h4>-->
<!--<h4>Construction Status: {{ property.construction_status }}</h4>-->
<!--<h4>Area: {{ property.area }} sq. ft.</h4>-->
<!--<h4>Address: {{ property.address }}</h4>-->
<!--<h4>Description: {{ property.description }}</h4>-->


<!--Comments begin here -->
<!--<div class="card">-->
<!--<div class="card-header text-white bg-warning">-->
<!--Comments-->
<!--</div>-->
<!--<div class="card-body">-->
<!--<ul class="list-group">-->
<!--{% for comment in comments %}-->
<!--{% ifequal comment.property_title property.property_title %}-->
<!--<li class="list-group-item">-->
<!--<h6>-->
<!--{{ comment.user }}-->
<!--<small>{{ comment.datetime }}</small>-->
<!--</h6>-->
<!--<p>{{ comment.comment }}</p>-->
<!--</li>-->
<!--{% endifequal %}-->
<!--{% endfor %}-->
<!--</ul>-->

<!--<h5 class="card-title">Special title treatment</h5>-->
<!--<p class="card-text">With supporting text below as a natural lead-in to additional content.</p>-->
<!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
<!--</div>-->
<!--</div>-->

<!--Some edits after this-->

<div class="card-header text-white bg-dark" id="comments">
    <strong>Comments:</strong>
</div>

<div class="card-body ">
    <ul class="list-group">
        {% for comment in comments %}
        {% ifequal comment.property_title property.property_title %}
        <li class="list-group-item">
            <h6>
                {{ comment.user }}
                <small>{{ comment.datetime }}</small>
            </h6>
            <p>{{ comment.comment }}</p>
        </li>
        {% endifequal %}
        {% endfor %}
    </ul>

    <!--taken till here -->
    <form class="form-horizontal" role="form" action="#comments" method="post"
          enctype="multipart/form-data">
        {% csrf_token %}
        <br>
        {% if user.is_authenticated %}
        {% ifequal user.type 'buyer' %}
        <textarea class="form-control form-control-md" id="a" name="a" placeholder="Your Comment" required></textarea>
        <div class="form-row">
            <div class="form-group">
                <div class="col-sm-offset-1 col-sm-10">
                    <br>
                    <button type="submit" class="btn btn-success">
                        <span>Submit</span>
                    </button>
                </div>
            </div>
        </div>
        {% else %}
        <div class="card">
            <div class="card-body">
                <label for="a">
                    <span>You need to be a registered buyer to post a comment. Login <a
                            href="{% url 'ecommerce:login_user' %}">here</a></span>
                </label>
            </div>
        </div>
        <br>
        <textarea class="form-control form-control-md" id="a" name="a"
                  placeholder="Your Comment" disabled>
        </textarea>
        <div class="form-row">
            <div class="form-group">
                <div class="col-sm-offset-1 col-sm-10">
                    <br>
                    <button type="submit" class="btn btn-success" disabled>
                        <span>Submit</span>
                    </button>
                </div>
            </div>
        </div>
        {% endifequal %}
        {% else %}
        <div class="card">
            <div class="card-body">
                <label for="a">
                    <span>You need to be a registered buyer to post a comment. Login <a
                            href="{% url 'ecommerce:login_user' %}">here</a></span>
                </label>
            </div>
        </div>

        <br>
        <textarea class="form-control form-control-md" id="a" name="a"
                  placeholder="Your Comment" disabled>
        </textarea>
        <div class="form-row">
            <div class="form-group">
                <div class="col-sm-offset-1 col-sm-10">
                    <br>
                    <button type="submit" class="btn btn-success" disabled>
                        <span>Submit</span>
                    </button>
                </div>
            </div>
        </div>
        {% endif %}
    </form>
</div>

{% endblock %}